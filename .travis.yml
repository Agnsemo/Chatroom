language: php

php: 
    - 7.4.3
    
branches:
    only:
        - tests

services:
    - mysql

before_script:
    - cp .env.dusk.local .env
    - composer require laravel/dusk:"^4.0"
    - composer update
    - php artisan dusk:install
    - mysql -u root -h 127.0.0.1 chat_db < chat_db.sql
    
script:
    - php artisan dusk
    
definitions:
 services:
   mysql:
     image: mysql:5.6
     environment:
        MYSQL_DATABASE: 'finansai'
        MYSQL_USER: 'root'
        MYSQL_ALLOW_EMPTY_PASSWORD: 'yes'
